{"version":3,"file":"FetchCollectionsMixin-BiU5FR8V.chunk.mjs","sources":["../src/mixins/FetchCollectionsMixin.js"],"sourcesContent":["/**\n * SPDX-FileCopyrightText: 2022 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { mapActions } from 'vuex'\n\nimport AbortControllerMixin from './AbortControllerMixin.js'\nimport { fetchCollections } from '../services/collectionFetcher.js'\nimport logger from '../services/logger.js'\n\nexport default {\n\tname: 'FetchCollectionsMixin',\n\n\tdata() {\n\t\treturn {\n\t\t\terrorFetchingCollections: null,\n\t\t\tloadingCollections: false,\n\t\t}\n\t},\n\n\tmixins: [\n\t\tAbortControllerMixin,\n\t],\n\n\tmethods: {\n\t\t...mapActions([\n\t\t\t'addCollections',\n\t\t]),\n\n\t\t/**\n\t\t * @param {string} collectionHome\n\t\t * @param {string[]} [extraProps] - Extra properties to add to the DAV request.\n\t\t * @param {import('webdav').WebDAVClient} [client] - The DAV client to use.\n\t\t * @return {Promise<import('../services/collectionFetcher.js').Collection[]>}\n\t\t */\n\t\tasync fetchCollections(collectionHome, extraProps, client) {\n\t\t\tif (this.loadingCollections) {\n\t\t\t\treturn []\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tthis.loadingCollections = true\n\t\t\t\tthis.errorFetchingCollections = null\n\n\t\t\t\tconst collections = await fetchCollections(collectionHome, { signal: this.abortController.signal }, extraProps, client)\n\n\t\t\t\tthis.addCollections({ collections })\n\n\t\t\t\treturn collections\n\t\t\t} catch (error) {\n\t\t\t\tif (error.response?.status === 404) {\n\t\t\t\t\tthis.errorFetchingCollections = 404\n\t\t\t\t} else {\n\t\t\t\t\tthis.errorFetchingCollections = error\n\t\t\t\t}\n\t\t\t\tlogger.error('Error fetching collections:', { error })\n\t\t\t} finally {\n\t\t\t\tthis.loadingCollections = false\n\t\t\t}\n\n\t\t\treturn []\n\t\t},\n\t},\n}\n"],"names":["FetchCollectionsMixin","AbortControllerMixin","mapActions","collectionHome","extraProps","client","collections","fetchCollections","error","logger"],"mappings":"+KAWA,MAAeA,EAAA,CACd,KAAM,wBAEN,MAAO,CACN,MAAO,CACN,yBAA0B,KAC1B,mBAAoB,EACvB,CACE,EAED,OAAQ,CACPC,CACA,EAED,QAAS,CACR,GAAGC,EAAW,CACb,gBACH,CAAG,EAQD,MAAM,iBAAiBC,EAAgBC,EAAYC,EAAQ,CAC1D,GAAI,KAAK,mBACR,MAAO,CAAA,EAGR,GAAI,CACH,KAAK,mBAAqB,GAC1B,KAAK,yBAA2B,KAEhC,MAAMC,EAAc,MAAMC,EAAiBJ,EAAgB,CAAE,OAAQ,KAAK,gBAAgB,QAAUC,EAAYC,CAAM,EAEtH,OAAK,KAAA,eAAe,CAAE,YAAAC,CAAa,CAAA,EAE5BA,CACP,OAAQE,EAAO,CACXA,EAAM,UAAU,SAAW,IAC9B,KAAK,yBAA2B,IAEhC,KAAK,yBAA2BA,EAEjCC,EAAO,MAAM,8BAA+B,CAAE,MAAAD,CAAO,CAAA,CACzD,QAAA,CACI,KAAK,mBAAqB,EAC9B,CAEG,MAAO,CAAA,CACP,CACD,CACF"}