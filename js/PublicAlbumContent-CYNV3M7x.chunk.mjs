(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode(".album[data-v-bcb74d89]{display:flex;flex-direction:column}.album__title[data-v-bcb74d89]{width:100%}.album__name[data-v-bcb74d89]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.album__location[data-v-bcb74d89]{margin-left:-4px;display:flex;color:var(--color-text-lighter)}")),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
import{A as l,C as a}from"./index-CYNaqKNs.chunk.mjs";import{M as n}from"./MapMarker-CwCyILXV.chunk.mjs";import{n as i}from"./index-Y-UlKA14.chunk.mjs";import{t as s,_ as r,T as c,a8 as m}from"./vue.runtime.esm-Cvc35Ey2.chunk.mjs";import{N as u}from"./NcEmptyContent-D1s5wRoX.chunk.mjs";import{i as h}from"./isMobile-Ba3bAK4k.chunk.mjs";import{C as p}from"./CollectionContent-dPvYzEj6.chunk.mjs";import{H as d}from"./HeaderNavigation-DOQtZJ1K.chunk.mjs";import{F as b}from"./FetchCollectionContentMixin-VQw2L6ZW.chunk.mjs";import"./AlertCircle-BgUCrioB.chunk.mjs";import"./FolderMultipleImage-C1PTCIsG.chunk.mjs";import"./FilesListViewer-CuvsdS1s.chunk.mjs";import"./fileFetcher-DueDmSo0.chunk.mjs";import"./File-Cvym3RbQ.chunk.mjs";import"./Video-BMa4IOkQ.chunk.mjs";import"./ArrowLeft-DiWsGsl6.chunk.mjs";import"./AbortControllerMixin-DeafVJKx.chunk.mjs";import"./collectionFetcher-Bm9B5t5x.chunk.mjs";const f={name:"ImageOffIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var g=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon image-off-icon",attrs:{"aria-hidden":t.title?null:"true","aria-label":t.title,role:"img"},on:{click:function(o){return t.$emit("click",o)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M21 17.2L6.8 3H19C20.1 3 21 3.9 21 5V17.2M20.7 22L19.7 21H5C3.9 21 3 20.1 3 19V4.3L2 3.3L3.3 2L22 20.7L20.7 22M16.8 18L12.9 14.1L11 16.5L8.5 13.5L5 18H16.8Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])},C=[],v=i(f,g,C,!1,null,null);const F=v.exports,N={name:"PublicAlbumContent",components:{MapMarker:n,ImageOff:F,NcEmptyContent:u,NcActions:a,CollectionContent:p,HeaderNavigation:d},mixins:[b,h],props:{token:{type:String,required:!0}},data(){return{showAddPhotosModal:!1,loadingCount:0,loadingAddFilesToAlbum:!1,albumOriginalName:"",publicClient:c(m("dav"),{Authorization:`Basic ${btoa(`${this.token}:`)}`})}},computed:{album(){return this.$store.getters.getPublicAlbum(this.albumName)},albumName(){return this.token},albumFileIds(){return this.$store.getters.getPublicAlbumFiles(this.albumName)},publicAlbumFileName(){return this.$store.getters.getPublicAlbumName(this.albumName)}},async beforeMount(){await this.fetchAlbumInfo(),await this.fetchAlbumContent()},methods:{...l(["appendFiles","addCollection","addFilesToCollection","removeFilesFromCollection"]),async fetchAlbumInfo(){const t=await this.fetchCollection(`/photospublic/${this.token}`,["<nc:location />","<nc:dateRange />","<nc:collaborators />","<nc:original-name />"],this.publicClient);this.albumOriginalName=t.originalName},async fetchAlbumContent(){await this.fetchCollectionFiles(`/photospublic/${this.token}`,["<nc:location />","<nc:dateRange />","<nc:collaborators />","<nc:original-name />"],this.publicClient,[t=>({...t,previewUrl:r(`/apps/photos/api/v1/publicPreview/${t.fileid}?x=2048&y=2048&token=${this.token}`),hasPreview:!1})])},async handleFilesPicked(t){this.showAddPhotosModal=!1,await this.addFilesToCollection({collectionFileName:this.albumName,fileIdsToAdd:t}),await this.fetchAlbumContent()},async handleRemoveFilesFromAlbum(t){this.$refs.collectionContent.onUncheckFiles(t),await this.removeFilesFromCollection({collectionFileName:this.albumName,fileIdsToRemove:t})},t:s}};var _=function(){var t=this,e=t._self._c;return e("div",[e("CollectionContent",{ref:"collectionContent",attrs:{collection:t.album,"collection-file-ids":t.albumFileIds,"allow-selection":!1,loading:t.loadingCollection||t.loadingCollectionFiles,error:t.errorFetchingCollection||t.errorFetchingCollectionFiles},scopedSlots:t._u([{key:"header",fn:function({selectedFileIds:o}){return t.albumOriginalName!==""?e("HeaderNavigation",{key:"navigation",attrs:{loading:t.loadingCollection||t.loadingCollectionFiles,params:{token:t.token},path:"/","root-title":t.albumOriginalName,title:t.albumOriginalName},on:{refresh:t.fetchAlbumContent}},[t.album.location!==""?e("div",{staticClass:"album__location",attrs:{slot:"subtitle"},slot:"subtitle"},[e("MapMarker"),t._v(t._s(t.album.location)+" ")],1):t._e(),t.album!==void 0?e("template",{slot:"right"},[e("NcActions",{attrs:{"force-menu":!0,"aria-label":t.t("photos","Open actions menu")}},[o.length>0?void 0:t._e()],2)],1):t._e()],2):t._e()}}],null,!0)},[e("NcEmptyContent",{staticClass:"album__empty",attrs:{slot:"empty-content",name:t.t("photos","This album does not have any photos or videos yet!")},slot:"empty-content"},[e("ImageOff",{attrs:{slot:"icon"},slot:"icon"})],1)],1)],1)},A=[],y=i(N,_,A,!1,null,"bcb74d89");const q=y.exports;export{q as default};
//# sourceMappingURL=PublicAlbumContent-CYNV3M7x.chunk.mjs.map
