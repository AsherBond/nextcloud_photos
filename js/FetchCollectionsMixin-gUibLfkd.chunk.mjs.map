{"version":3,"file":"FetchCollectionsMixin-gUibLfkd.chunk.mjs","sources":["../src/mixins/FetchCollectionsMixin.ts"],"sourcesContent":["/**\n * SPDX-FileCopyrightText: 2022 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { mapActions } from 'vuex'\n\nimport AbortControllerMixin from './AbortControllerMixin.js'\nimport { fetchCollections, type Collection } from '../services/collectionFetcher.js'\nimport logger from '../services/logger.js'\nimport type { WebDAVClient } from 'webdav'\n\nexport default {\n\tname: 'FetchCollectionsMixin',\n\n\tdata() {\n\t\treturn {\n\t\t\terrorFetchingCollections: null,\n\t\t\tloadingCollections: false,\n\t\t}\n\t},\n\n\tmixins: [\n\t\tAbortControllerMixin,\n\t],\n\n\tmethods: {\n\t\t...mapActions([\n\t\t\t'addCollections',\n\t\t]),\n\n\t\tasync fetchCollections(collectionHome: string, extraProps: string[], client: WebDAVClient): Promise<Collection[]> {\n\t\t\tif (this.loadingCollections) {\n\t\t\t\treturn []\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tthis.loadingCollections = true\n\t\t\t\tthis.errorFetchingCollections = null\n\n\t\t\t\tconst collections = await fetchCollections(collectionHome, { signal: this.abortController.signal }, extraProps, client)\n\n\t\t\t\tthis.addCollections({ collections })\n\n\t\t\t\treturn collections\n\t\t\t} catch (error) {\n\t\t\t\tif (error.response?.status === 404) {\n\t\t\t\t\tthis.errorFetchingCollections = 404\n\t\t\t\t} else {\n\t\t\t\t\tthis.errorFetchingCollections = error\n\t\t\t\t}\n\t\t\t\tlogger.error('Error fetching collections:', { error })\n\t\t\t} finally {\n\t\t\t\tthis.loadingCollections = false\n\t\t\t}\n\n\t\t\treturn []\n\t\t},\n\t},\n}\n"],"names":["FetchCollectionsMixin","AbortControllerMixin","mapActions","collectionHome","extraProps","client","collections","fetchCollections","error","logger"],"mappings":"+KAYA,MAAeA,EAAA,CACd,KAAM,wBAEN,MAAO,CACC,MAAA,CACN,yBAA0B,KAC1B,mBAAoB,EACrB,CACD,EAEA,OAAQ,CACPC,CACD,EAEA,QAAS,CACR,GAAGC,EAAW,CACb,gBAAA,CACA,EAED,MAAM,iBAAiBC,EAAwBC,EAAsBC,EAA6C,CACjH,GAAI,KAAK,mBACR,MAAO,CAAC,EAGL,GAAA,CACH,KAAK,mBAAqB,GAC1B,KAAK,yBAA2B,KAE1B,MAAAC,EAAc,MAAMC,EAAiBJ,EAAgB,CAAE,OAAQ,KAAK,gBAAgB,QAAUC,EAAYC,CAAM,EAEjH,OAAA,KAAA,eAAe,CAAE,YAAAC,EAAa,EAE5BA,QACCE,EAAO,CACXA,EAAM,UAAU,SAAW,IAC9B,KAAK,yBAA2B,IAEhC,KAAK,yBAA2BA,EAEjCC,EAAO,MAAM,8BAA+B,CAAE,MAAAD,CAAA,CAAO,CAAA,QAAA,CAErD,KAAK,mBAAqB,EAAA,CAG3B,MAAO,CAAC,CAAA,CACT,CAEF"}