(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode(".album-container[data-v-d94b69a4],.album-container[data-v-d94b69a4] .collection{height:100%}.album__title[data-v-d94b69a4]{width:100%}.album__name[data-v-d94b69a4]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.album__location[data-v-d94b69a4]{margin-left:-4px;display:flex;color:var(--color-text-lighter)}")),document.head.appendChild(e)}}catch(a){console.error("vite-plugin-css-injected-by-js",a)}})();
import{A as i,y as s,o as n,B as r,e as m,C as c,D as u,f as d}from"./index-CHIr7m_h.chunk.mjs";import{N as b}from"./index-Dkr9ebK1-B4x7u5Cy.chunk.mjs";import{t as h}from"./vue.runtime.esm-D5CTWQro.chunk.mjs";import{N as p}from"./NcEmptyContent-CuN02Q0X.chunk.mjs";import{i as f}from"./isMobile-DH7oJpfQ.chunk.mjs";import{C}from"./Close-FazkRAnf.chunk.mjs";import{D as A}from"./FilesByMonthMixin-BJHS2Pry.chunk.mjs";import{I as N}from"./ImagePlus-YiR1xJff.chunk.mjs";import{M as g}from"./MapMarker-BPHgGMM-.chunk.mjs";import{P as F}from"./Pencil-BwLKc9xp.chunk.mjs";import{P as _}from"./Plus-Cl6w8yyg.chunk.mjs";import{S as v}from"./ShareVariant-pCrDMf4X.chunk.mjs";import{F as y}from"./FetchFilesMixin-D04wBA-f.chunk.mjs";import{F as w}from"./FetchCollectionContentMixin-BbZx1Fj_.chunk.mjs";import{A as k}from"./ActionFavorite-BAig078i.chunk.mjs";import{C as P,A as M}from"./AlbumForm-NAhljYlv.chunk.mjs";import{C as S}from"./CollectionContent-BdweyarE.chunk.mjs";import{P as E}from"./PhotosPicker-DimCc6wt.chunk.mjs";import{H as I}from"./HeaderNavigation-D_qlcfzt.chunk.mjs";import{n as B}from"./index-BU47S74H.chunk.mjs";import"./preload-helper-Dh9HmuEY.chunk.mjs";import"./index-CksgHjU4.chunk.mjs";import"./index-cOHGKXjJ.chunk.mjs";import"./PhotoSearch-D6Q3fChM.chunk.mjs";import"./AbortControllerMixin-DeafVJKx.chunk.mjs";import"./collectionFetcher-DWPT0bzn.chunk.mjs";import"./Star-DgQYYCOW.chunk.mjs";import"./Send-DJLMwEfs.chunk.mjs";import"./AccountGroup-SOSQyWVT.chunk.mjs";import"./index-BycAmYAy.chunk.mjs";import"./AlertCircle-DB37FM5H.chunk.mjs";import"./FolderMultipleImage-BNN-45ZL.chunk.mjs";import"./FilesListViewer-DfNhkDx4.chunk.mjs";import"./fileFetcher-Ce96JpxJ.chunk.mjs";import"./File-DzcOh6he.chunk.mjs";import"./Video-DUfPVCSI.chunk.mjs";import"./NcNoteCard-jr2svfW2.chunk.mjs";import"./ArrowLeft-Byqv_MPl.chunk.mjs";const D={name:"AlbumContent",components:{ActionFavorite:k,AlbumForm:M,Close:C,CollaboratorsSelectionForm:P,CollectionContent:S,Delete:A,PhotosPicker:E,HeaderNavigation:I,ImagePlus:N,MapMarker:g,NcActionButton:u,NcActions:c,NcActionSeparator:b,NcButton:m,NcDialog:r,NcEmptyContent:p,NcLoadingIcon:n,NcModal:s,Pencil:F,Plus:_,ShareVariant:v},mixins:[w,y,f],props:{albumName:{type:String,default:"/"}},data(){return{showAddPhotosModal:!1,showManageCollaboratorView:!1,showEditAlbumForm:!1,loadingAddCollaborators:!1}},computed:{album(){return this.$store.getters.getAlbum(this.albumName)},albumFileIds(){return this.$store.getters.getAlbumFiles(this.albumName)},sharingEnabled(){return OC.Share!==void 0},albumFileName(){return this.$store.getters.getAlbumName(this.albumName)}},async mounted(){this.fetchAlbum(),this.fetchAlbumContent()},methods:{...i(["addFilesToCollection","removeFilesFromCollection","deleteCollection","updateCollection"]),async fetchAlbum(){await this.fetchCollection(this.albumFileName,["<nc:location />","<nc:dateRange />","<nc:collaborators />"])},async fetchAlbumContent(){await this.fetchCollectionFiles(this.albumFileName)},redirectToNewName({album:o}){this.showEditAlbumForm=!1,this.album.basename!==o.basename&&this.$router.push(`/albums/${o.basename}`)},async handleFilesPicked(o){this.showAddPhotosModal=!1,await this.addFilesToCollection({collectionFileName:this.album.filename,fileIdsToAdd:o}),await this.fetchAlbumContent()},async handleRemoveFilesFromAlbum(o){this.$refs.collectionContent.onUncheckFiles(o),await this.removeFilesFromCollection({collectionFileName:this.album.filename,fileIdsToRemove:o})},async handleDeleteAlbum(){await this.deleteCollection({collectionFileName:this.album.filename}),this.$router.push("/albums")},async handleSetCollaborators(o){try{this.loadingAddCollaborators=!0,this.showManageCollaboratorView=!1,await this.updateCollection({collectionFileName:this.album.filename,properties:{collaborators:o}})}catch(t){d.error("Error while setting album collaborators",{error:t})}finally{this.loadingAddCollaborators=!1}},t:h}};var T=function(){var o=this,t=o._self._c;return t("div",{staticClass:"album-container"},[t("CollectionContent",{ref:"collectionContent",attrs:{collection:o.album,"collection-file-ids":o.albumFileIds,loading:o.loadingCollection||o.loadingCollectionFiles,error:o.errorFetchingCollection||o.errorFetchingCollectionFiles},scopedSlots:o._u([{key:"header",fn:function({selectedFileIds:l,resetSelection:e}){return t("HeaderNavigation",{key:"navigation",attrs:{loading:o.loadingCollectionFiles,params:{albumName:o.albumName},path:"/"+o.albumName,title:o.albumName},on:{refresh:o.fetchAlbumContent}},[o.album!==void 0&&o.album.location!==""?t("div",{staticClass:"album__location",attrs:{slot:"subtitle"},slot:"subtitle"},[t("MapMarker"),o._v(o._s(o.album.location)+" ")],1):o._e(),t("template",{slot:"default"},[l.length>0?t("NcButton",{attrs:{"aria-label":o.t("photos","Unselect all")},on:{click:e},scopedSlots:o._u([{key:"icon",fn:function(){return[t("Close")]},proxy:!0}],null,!0)},[o._v(" "+o._s(o.t("photos","Unselect all"))+" ")]):o._e()],1),o.album!==void 0?t("template",{slot:"right"},[t("NcButton",{on:{click:function(a){o.showAddPhotosModal=!0}},scopedSlots:o._u([{key:"icon",fn:function(){return[t("Plus",{attrs:{size:20}})]},proxy:!0}],null,!0)},[o._v(" "+o._s(o.t("photos","Add photos to this album"))+" ")]),o.sharingEnabled?t("NcButton",{attrs:{type:"tertiary","aria-label":o.t("photos","Manage collaborators for this album")},on:{click:function(a){o.showManageCollaboratorView=!0}}},[t("ShareVariant",{attrs:{slot:"icon"},slot:"icon"})],1):o._e(),t("NcActions",{attrs:{"aria-label":o.t("photos","Open actions menu")}},[t("NcActionButton",{attrs:{"close-after-click":!0,"aria-label":o.t("photos","Edit album details")},on:{click:function(a){o.showEditAlbumForm=!0}}},[o._v(" "+o._s(o.t("photos","Edit album details"))+" "),t("Pencil",{attrs:{slot:"icon"},slot:"icon"})],1),t("NcActionButton",{attrs:{"close-after-click":!0},on:{click:o.handleDeleteAlbum}},[o._v(" "+o._s(o.t("photos","Delete album"))+" "),t("Delete",{attrs:{slot:"icon"},slot:"icon"})],1),l.length>0?[t("NcActionSeparator"),t("ActionFavorite",{attrs:{"selected-file-ids":l}}),t("NcActionButton",{attrs:{"close-after-click":!0},on:{click:function(a){return o.handleRemoveFilesFromAlbum(l)}}},[o._v(" "+o._s(o.t("photos","Remove selection from album"))+" "),t("Close",{attrs:{slot:"icon"},slot:"icon"})],1)]:o._e()],2)],1):o._e()],2)}}])},[o.album!==void 0&&o.album.nbItems===0&&!(o.loadingCollectionFiles||o.loadingCollection)?t("NcEmptyContent",{staticClass:"album__empty",attrs:{slot:"empty-content",name:o.t("photos","This album does not have any photos or videos yet!")},slot:"empty-content"},[t("ImagePlus",{attrs:{slot:"icon"},slot:"icon"}),t("NcButton",{staticClass:"album__empty__button",attrs:{slot:"action",type:"primary","aria-label":o.t("photos","Add photos to this album")},on:{click:function(l){o.showAddPhotosModal=!0}},slot:"action"},[t("Plus",{attrs:{slot:"icon"},slot:"icon"}),o._v(" "+o._s(o.t("photos","Add"))+" ")],1)],1):o._e()],1),o.album!==void 0?t("PhotosPicker",{attrs:{open:o.showAddPhotosModal,"blacklist-ids":o.albumFileIds,destination:o.album.basename,name:o.t("photos","Add photos to {albumName}",{albumName:o.albumName})},on:{"update:open":function(l){o.showAddPhotosModal=l},"files-picked":o.handleFilesPicked}}):o._e(),o.showManageCollaboratorView&&o.album!==void 0?t("NcModal",{attrs:{name:o.t("photos","Manage collaborators")},on:{close:function(l){o.showManageCollaboratorView=!1}}},[t("CollaboratorsSelectionForm",{attrs:{"album-name":o.album.basename,collaborators:o.album.collaborators},scopedSlots:o._u([{key:"default",fn:function({collaborators:l}){return[t("NcButton",{attrs:{"aria-label":o.t("photos","Save collaborators for this album."),type:"primary",disabled:o.loadingAddCollaborators},on:{click:function(e){return o.handleSetCollaborators(l)}},scopedSlots:o._u([{key:"icon",fn:function(){return[o.loadingAddCollaborators?t("NcLoadingIcon"):o._e()]},proxy:!0}],null,!0)},[o._v(" "+o._s(o.t("photos","Save"))+" ")])]}}],null,!1,507271420)})],1):o._e(),o.showEditAlbumForm?t("NcDialog",{attrs:{name:o.t("photos","Edit album details"),"close-on-click-outside":"",size:"normal"},on:{closing:function(l){o.showEditAlbumForm=!1}}},[t("AlbumForm",{attrs:{album:o.album},on:{done:o.redirectToNewName}})],1):o._e()],1)},V=[],$=B(D,T,V,!1,null,"d94b69a4");const _o=$.exports;export{_o as default};
//# sourceMappingURL=AlbumContent-Z4qn0Pbu.chunk.mjs.map
