import{A as i,C as l}from"./index-py_2m8-F.chunk.mjs";import{j as a,M as n,n as s}from"./icons-CCMXs15V.chunk.mjs";import{t as r,_ as c,R as m,a6 as u}from"./vue.runtime.esm-K-L1yEsQ.chunk.mjs";import{N as h}from"./NcEmptyContent-g9nttIbV.chunk.mjs";import{i as d}from"./isMobile-DfLql851.chunk.mjs";import{C as b}from"./CollectionContent-bs2KX5o9.chunk.mjs";import{H as p}from"./HeaderNavigation-lxAaZ4ct.chunk.mjs";import{F as f}from"./FetchCollectionContentMixin-ChRkOUWO.chunk.mjs";import"./index-D-GU54Qs.chunk.mjs";import"./FilesListViewer-CgMDfL4E.chunk.mjs";import"./fileFetcher-BIoD3dZH.chunk.mjs";import"./File-CpggQ5HL.chunk.mjs";import"./AbortControllerMixin-DeafVJKx.chunk.mjs";import"./collectionFetcher-DlaOYm_F.chunk.mjs";const g={name:"PublicAlbumContent",components:{MapMarker:n,ImageOff:a,NcEmptyContent:h,NcActions:l,CollectionContent:b,HeaderNavigation:p},mixins:[f,d],props:{token:{type:String,required:!0}},data(){return{showAddPhotosModal:!1,loadingCount:0,loadingAddFilesToAlbum:!1,albumOriginalName:"",publicClient:m(u("dav"),{Authorization:`Basic ${btoa(`${this.token}:`)}`})}},computed:{album(){return this.$store.getters.getPublicAlbum(this.albumName)},albumName(){return this.token},albumFileIds(){return this.$store.getters.getPublicAlbumFiles(this.albumName)},publicAlbumFileName(){return this.$store.getters.getPublicAlbumName(this.albumName)}},async beforeMount(){await this.fetchAlbumInfo(),await this.fetchAlbumContent()},methods:{...i(["appendFiles","addCollection","addFilesToCollection","removeFilesFromCollection"]),async fetchAlbumInfo(){const t=await this.fetchCollection(`/photospublic/${this.token}`,["<nc:location />","<nc:dateRange />","<nc:collaborators />","<nc:original-name />"],this.publicClient);this.albumOriginalName=t.originalName},async fetchAlbumContent(){await this.fetchCollectionFiles(`/photospublic/${this.token}`,["<nc:location />","<nc:dateRange />","<nc:collaborators />","<nc:original-name />"],this.publicClient,[t=>({...t,previewUrl:c(`/apps/photos/api/v1/publicPreview/${t.fileid}?x=2048&y=2048&token=${this.token}`),hasPreview:!1})])},async handleFilesPicked(t){this.showAddPhotosModal=!1,await this.addFilesToCollection({collectionFileName:this.albumName,fileIdsToAdd:t}),await this.fetchAlbumContent()},async handleRemoveFilesFromAlbum(t){this.$refs.collectionContent.onUncheckFiles(t),await this.removeFilesFromCollection({collectionFileName:this.albumName,fileIdsToRemove:t})},t:r}};var C=function(){var t=this,o=t._self._c;return o("div",[o("CollectionContent",{ref:"collectionContent",attrs:{collection:t.album,"collection-file-ids":t.albumFileIds,"allow-selection":!1,loading:t.loadingCollection||t.loadingCollectionFiles,error:t.errorFetchingCollection||t.errorFetchingCollectionFiles},scopedSlots:t._u([{key:"header",fn:function({selectedFileIds:e}){return t.albumOriginalName!==""?o("HeaderNavigation",{key:"navigation",attrs:{loading:t.loadingCollection||t.loadingCollectionFiles,params:{token:t.token},path:"/","root-title":t.albumOriginalName,title:t.albumOriginalName},on:{refresh:t.fetchAlbumContent}},[t.album.location!==""?o("div",{staticClass:"album__location",attrs:{slot:"subtitle"},slot:"subtitle"},[o("MapMarker"),t._v(t._s(t.album.location)+" ")],1):t._e(),t.album!==void 0?o("template",{slot:"right"},[o("NcActions",{attrs:{"force-menu":!0,"aria-label":t.t("photos","Open actions menu")}},[e.length>0?void 0:t._e()],2)],1):t._e()],2):t._e()}}],null,!0)},[o("NcEmptyContent",{staticClass:"album__empty",attrs:{slot:"empty-content",name:t.t("photos","This album does not have any photos or videos yet!")},slot:"empty-content"},[o("ImageOff",{attrs:{slot:"icon"},slot:"icon"})],1)],1)],1)},F=[],N=s(g,C,F,!1,null,"bcb74d89");const H=N.exports;export{H as default};
//# sourceMappingURL=PublicAlbumContent-CoNuKPZW.chunk.mjs.map
