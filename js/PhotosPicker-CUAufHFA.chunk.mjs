(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode("[data-v-073d2240] .photos-picker{display:flex;padding-inline-end:0!important}.photos-picker__navigation__month[data-v-073d2240]{margin:4px}.photos-picker__navigation__month-select[data-v-073d2240]{flex:1;padding-inline-end:12px;padding-block-end:6px}.photos-picker__file-list[data-v-073d2240]{flex-grow:1;min-width:0;height:100%;padding:0 4px}.photos-picker__file-list--placeholder[data-v-073d2240]{background:var(--color-primary-element-light);border-radius:var(--border-radius-large)}.photos-picker__file-list .section-header[data-v-073d2240]{font-weight:700;font-size:20px;padding:8px 0 4px}.photos-picker__file-list[data-v-073d2240] .empty-content{height:-moz-fit-content;height:fit-content;margin-block:1em;margin-inline-end:12px;width:calc(100% - 12px)}.photos-picker__actions[data-v-073d2240]{display:flex;flex-direction:column;flex-grow:1}.photos-picker__actions__buttons[data-v-073d2240]{display:flex;align-items:center;justify-content:flex-end;gap:16px}")),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
import{d as r,g as l}from"./vue.runtime.esm-K-L1yEsQ.chunk.mjs";import{U as c}from"./index-Dkr9ebK1-D1dImON9.chunk.mjs";import{x as d,E as p,o as h,B as u,e as m,q as f,a as g}from"./index-BYQN7aMH.chunk.mjs";import{N as _}from"./NcNoteCard-dcPuzGn9.chunk.mjs";import{m as n,n as M}from"./index-Dq3i_7qQ.chunk.mjs";import{I as k}from"./ImagePlus-CLW7iRUp.chunk.mjs";import{F as y,a as F}from"./FilesListViewer-CASfW7KC.chunk.mjs";import{F as b}from"./File-BXkbD6Ma.chunk.mjs";import{F as Y}from"./FetchFilesMixin-L5phQwy1.chunk.mjs";import{F as v}from"./FilesByMonthMixin-DoBenXFe.chunk.mjs";const L=r({name:"PhotosPicker",components:{File:b,FilesListViewer:F,ImagePlus:k,NcButton:m,NcDialog:u,NcLoadingIcon:h,NcSelect:p,NcNoteCard:_,UploadPicker:c},mixins:[Y,v,y],props:{open:{type:Boolean,default:!0},name:{type:String,required:!0},destination:{type:String,required:!0},blacklistIds:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["files-picked","update:open"],setup(){return{isMobile:g()}},data(){return{allowedMimes:f,targetMonth:null,uploadContext:{route:"albumpicker"},currentUser:l().uid}},computed:{...d(["files"]),photosLocationFolder(){return this.$store.state.userConfig.photosLocationFolder}},watch:{monthsList(t){this.targetMonth===null&&(this.targetMonth=t[0])}},methods:{onFocusOut(t){t.relatedTarget===null&&t.target.focus({preventScroll:!0})},getFiles(){this.fetchFiles({},this.blacklistIds)},refreshFiles(){this.fetchFiles({firstResult:0},[...this.blacklistIds,...this.fetchedFileIds],!0)},emitPickedEvent(){this.$emit("files-picked",this.selectedFileIds)},dateMonthAndYear(t){return this.isMobile?n(t,"YYYYMM").format("MMM YYYY"):n(t,"YYYYMM").format("MMMM YYYY")}}});var N=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("NcDialog",{attrs:{"content-classes":"photos-picker",name:t.name,open:t.open,"out-transition":"",size:"large"},on:{"update:open":s=>t.$emit("update:open",s)},scopedSlots:t._u([t.monthsList.length>0?{key:"navigation",fn:function({isCollapsed:s}){return[s?e("NcSelect",{staticClass:"photos-picker__navigation__month-select",attrs:{"aria-label-listbox":t.t("photos","Dates"),clearable:!1,"input-label":t.t("photos","Jump to specific date in list"),options:t.monthsList},scopedSlots:t._u([{key:"selected-option",fn:function({label:o}){return[t._v(" "+t._s(t.dateMonthAndYear(o))+" ")]}},{key:"option",fn:function({label:o}){return[t._v(" "+t._s(t.dateMonthAndYear(o))+" ")]}}],null,!0),model:{value:t.targetMonth,callback:function(o){t.targetMonth=o},expression:"targetMonth"}}):e("ul",{attrs:{"aria-label":t.t("photos","Dates")}},t._l(t.monthsList,function(o){return e("li",{key:o,staticClass:"photos-picker__navigation__month"},[e("NcButton",{attrs:{type:t.targetMonth===o?"secondary":"tertiary","aria-label":t.t("photos","Jump to {date}",{date:t.dateMonthAndYear(o)})},on:{click:function(i){t.targetMonth=o}}},[t._v(" "+t._s(t.dateMonthAndYear(o))+" ")])],1)}),0)]}}:null,{key:"actions",fn:function(){return[e("div",{staticClass:"photos-picker__actions"},[e("div",{staticClass:"photos-picker__actions__buttons"},[e("UploadPicker",{attrs:{accept:t.allowedMimes,context:t.uploadContext,destination:t.photosLocationFolder,multiple:""},on:{uploaded:t.refreshFiles}}),e("NcButton",{attrs:{type:"primary",disabled:t.loading||t.selectedFileIds.length===0},on:{click:t.emitPickedEvent},scopedSlots:t._u([{key:"icon",fn:function(){return[t.loading?t._e():e("ImagePlus"),t.loading?e("NcLoadingIcon"):t._e()]},proxy:!0}])},[t._v(" "+t._s(t.t("photos","Add to {destination}",{destination:t.destination}))+" ")])],1),t.photosLocationFolder.attributes["owner-id"]!==t.currentUser?e("NcNoteCard",{attrs:{type:"warning"}},[t._v(" "+t._s(t.t("photos","The destination folder is owned by {owner}",{owner:t.photosLocationFolder.attributes["owner-id"]}))+" ")]):t._e()],1)]},proxy:!0}],null,!0)},[e("FilesListViewer",{staticClass:"photos-picker__file-list",class:{"photos-picker__file-list--placeholder":t.monthsList.length===0},attrs:{"file-ids-by-section":t.fileIdsByMonth,"empty-message":t.t("photos","There are no photos or videos yet!"),sections:t.monthsList,loading:t.loadingFiles,"base-height":100,"section-header-height":50,"scroll-to-section":t.targetMonth},on:{"need-content":t.getFiles},nativeOn:{focusout:function(s){return t.onFocusOut.apply(null,arguments)}},scopedSlots:t._u([{key:"default",fn:function({file:s,height:o,isHeader:i,distance:a}){return[i?e("h3",{staticClass:"section-header",style:{height:`${o}px`},attrs:{id:`photos-picker-section-header-${s.id}`}},[t._v(" "+t._s(t.dateMonthAndYear(s.id))+" ")]):e("File",{attrs:{file:t.files[s.id],"allow-selection":!0,selected:t.selection[s.id]===!0,distance:a},on:{"select-toggled":t.onFileSelectToggle}})]}}])})],1)},x=[],w=M(L,N,x,!1,null,"073d2240");const q=w.exports;export{q as P};
//# sourceMappingURL=PhotosPicker-CUAufHFA.chunk.mjs.map
