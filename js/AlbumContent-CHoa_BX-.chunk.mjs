(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode(".album-container[data-v-42559684],.album-container[data-v-42559684] .collection{height:100%}.album__title[data-v-42559684]{width:100%}.album__name[data-v-42559684]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.album__location[data-v-42559684]{margin-left:-4px;display:flex;color:var(--color-text-lighter)}")),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
import{A as i,y as s,o as n,B as r,e as m,C as c,D as u,f as d}from"./index-C-nSEKko.chunk.mjs";import{N as b}from"./index-Dkr9ebK1-6RmNRdR6.chunk.mjs";import{t as h}from"./vue.runtime.esm-CShV2ddg.chunk.mjs";import{N as p}from"./NcEmptyContent-CVSj5Uvi.chunk.mjs";import{i as f}from"./isMobile-3hTp7V56.chunk.mjs";import{C}from"./Close-Dmosf-cz.chunk.mjs";import{D as A}from"./FilesByMonthMixin-Cfra1u3s.chunk.mjs";import{I as N}from"./ImagePlus-BRI6JSeX.chunk.mjs";import{M as g}from"./MapMarker-CgE-v1Jq.chunk.mjs";import{P as F}from"./Pencil-lOVcQ9ad.chunk.mjs";import{P as _}from"./Plus-DI46NFAE.chunk.mjs";import{S as v}from"./ShareVariant-7WtniNiS.chunk.mjs";import{F as y}from"./FetchFilesMixin-BlXkBofu.chunk.mjs";import{F as w}from"./FetchCollectionContentMixin-BQBuyj10.chunk.mjs";import{A as k}from"./ActionFavorite-CYz4yHQD.chunk.mjs";import{C as P,A as M}from"./AlbumForm-ZC3TTnim.chunk.mjs";import{C as S}from"./CollectionContent-CT1_hnE3.chunk.mjs";import{P as E}from"./PhotosPicker-CVdC7a8g.chunk.mjs";import{H as I}from"./HeaderNavigation-GHC6qaxt.chunk.mjs";import{n as B}from"./index-BGGeUZyp.chunk.mjs";import"./preload-helper-BmjW8Ca_.chunk.mjs";import"./index-CFAu3O9C.chunk.mjs";import"./PhotoSearch-CMraq11m.chunk.mjs";import"./AbortControllerMixin-DeafVJKx.chunk.mjs";import"./collectionFetcher-CyPMU7pv.chunk.mjs";import"./Star-DYRaZhps.chunk.mjs";import"./Send-CNb2uY9Q.chunk.mjs";import"./AccountGroup-8Tdb_ENm.chunk.mjs";import"./index-C-6-aqFr.chunk.mjs";import"./AlertCircle-vnm3VuFU.chunk.mjs";import"./FolderMultipleImage-BNFm9Uql.chunk.mjs";import"./FilesListViewer-9UrVi047.chunk.mjs";import"./fileFetcher-AX83eq7r.chunk.mjs";import"./File-Bj3FpHMy.chunk.mjs";import"./Video-BPHakcg5.chunk.mjs";import"./NcNoteCard-DLrFxU26.chunk.mjs";import"./ArrowLeft-DdMcagSU.chunk.mjs";const D={name:"AlbumContent",components:{ActionFavorite:k,AlbumForm:M,Close:C,CollaboratorsSelectionForm:P,CollectionContent:S,Delete:A,PhotosPicker:E,HeaderNavigation:I,ImagePlus:N,MapMarker:g,NcActionButton:u,NcActions:c,NcActionSeparator:b,NcButton:m,NcDialog:r,NcEmptyContent:p,NcLoadingIcon:n,NcModal:s,Pencil:F,Plus:_,ShareVariant:v},mixins:[w,y,f],props:{albumName:{type:String,default:"/"}},data(){return{showAddPhotosModal:!1,showManageCollaboratorView:!1,showEditAlbumForm:!1,loadingAddCollaborators:!1}},computed:{album(){return this.$store.getters.getAlbum(this.albumName)},albumFileIds(){return this.$store.getters.getAlbumFiles(this.albumName)},sharingEnabled(){return OC.Share!==void 0},albumFileName(){return this.$store.getters.getAlbumName(this.albumName)}},async mounted(){this.fetchAlbum(),this.fetchAlbumContent()},methods:{...i(["addFilesToCollection","removeFilesFromCollection","deleteCollection","updateCollection"]),async fetchAlbum(){await this.fetchCollection(this.albumFileName,["<nc:location />","<nc:dateRange />","<nc:collaborators />"])},async fetchAlbumContent(){await this.fetchCollectionFiles(this.albumFileName)},redirectToNewName({album:o}){this.showEditAlbumForm=!1,this.album.basename!==o.basename&&this.$router.push(`/albums/${o.basename}`)},async handleFilesPicked(o){this.showAddPhotosModal=!1,await this.addFilesToCollection({collectionFileName:this.album.filename,fileIdsToAdd:o}),await this.fetchAlbumContent()},async handleRemoveFilesFromAlbum(o){this.$refs.collectionContent.onUncheckFiles(o),await this.removeFilesFromCollection({collectionFileName:this.album.filename,fileIdsToRemove:o})},async handleDeleteAlbum(){await this.deleteCollection({collectionFileName:this.album.filename}),this.$router.push("/albums")},async handleSetCollaborators(o){try{this.loadingAddCollaborators=!0,this.showManageCollaboratorView=!1,await this.updateCollection({collectionFileName:this.album.filename,properties:{collaborators:o}})}catch(t){d.error("Error while setting album collaborators",{error:t})}finally{this.loadingAddCollaborators=!1}},t:h}};var T=function(){var o=this,t=o._self._c;return t("div",{staticClass:"album-container"},[t("CollectionContent",{ref:"collectionContent",attrs:{collection:o.album,"collection-file-ids":o.albumFileIds,loading:o.loadingCollection||o.loadingCollectionFiles,error:o.errorFetchingCollection||o.errorFetchingCollectionFiles},scopedSlots:o._u([{key:"header",fn:function({selectedFileIds:l,resetSelection:e}){return t("HeaderNavigation",{key:"navigation",attrs:{loading:o.loadingCollectionFiles,params:{albumName:o.albumName},path:"/"+o.albumName,title:o.albumName},on:{refresh:o.fetchAlbumContent}},[o.album!==void 0&&o.album.location!==""?t("div",{staticClass:"album__location",attrs:{slot:"subtitle"},slot:"subtitle"},[t("MapMarker"),o._v(o._s(o.album.location)+" ")],1):o._e(),t("template",{slot:"default"},[l.length>0?t("NcButton",{attrs:{"aria-label":o.t("photos","Unselect all")},on:{click:e},scopedSlots:o._u([{key:"icon",fn:function(){return[t("Close")]},proxy:!0}],null,!0)},[o._v(" "+o._s(o.t("photos","Unselect all"))+" ")]):o._e()],1),o.album!==void 0?t("template",{slot:"right"},[t("NcButton",{on:{click:function(a){o.showAddPhotosModal=!0}},scopedSlots:o._u([{key:"icon",fn:function(){return[t("Plus",{attrs:{size:20}})]},proxy:!0}],null,!0)},[o._v(" "+o._s(o.t("photos","Add photos to this album"))+" ")]),o.sharingEnabled?t("NcButton",{attrs:{type:"tertiary","aria-label":o.t("photos","Manage collaborators for this album")},on:{click:function(a){o.showManageCollaboratorView=!0}}},[t("ShareVariant",{attrs:{slot:"icon"},slot:"icon"})],1):o._e(),t("NcActions",{attrs:{"aria-label":o.t("photos","Open actions menu")}},[t("NcActionButton",{attrs:{"close-after-click":!0,"aria-label":o.t("photos","Edit album details")},on:{click:function(a){o.showEditAlbumForm=!0}}},[o._v(" "+o._s(o.t("photos","Edit album details"))+" "),t("Pencil",{attrs:{slot:"icon"},slot:"icon"})],1),t("NcActionButton",{attrs:{"close-after-click":!0},on:{click:o.handleDeleteAlbum}},[o._v(" "+o._s(o.t("photos","Delete album"))+" "),t("Delete",{attrs:{slot:"icon"},slot:"icon"})],1),l.length>0?[t("NcActionSeparator"),t("ActionFavorite",{attrs:{"selected-file-ids":l}}),t("NcActionButton",{attrs:{"close-after-click":!0},on:{click:function(a){return o.handleRemoveFilesFromAlbum(l)}}},[o._v(" "+o._s(o.t("photos","Remove selection from album"))+" "),t("Close",{attrs:{slot:"icon"},slot:"icon"})],1)]:o._e()],2)],1):o._e()],2)}}])},[o.album!==void 0&&o.album.nbItems===0&&!(o.loadingCollectionFiles||o.loadingCollection)?t("NcEmptyContent",{staticClass:"album__empty",attrs:{slot:"empty-content",name:o.t("photos","This album does not have any photos or videos yet!")},slot:"empty-content"},[t("ImagePlus",{attrs:{slot:"icon"},slot:"icon"}),t("NcButton",{staticClass:"album__empty__button",attrs:{slot:"action",type:"primary","aria-label":o.t("photos","Add photos to this album")},on:{click:function(l){o.showAddPhotosModal=!0}},slot:"action"},[t("Plus",{attrs:{slot:"icon"},slot:"icon"}),o._v(" "+o._s(o.t("photos","Add"))+" ")],1)],1):o._e()],1),o.album!==void 0?t("PhotosPicker",{attrs:{open:o.showAddPhotosModal,"blacklist-ids":o.albumFileIds,destination:o.album.basename,name:o.t("photos","Add photos to {albumName}",{albumName:o.albumName})},on:{"update:open":function(l){o.showAddPhotosModal=l},"files-picked":o.handleFilesPicked}}):o._e(),o.showManageCollaboratorView&&o.album!==void 0?t("NcModal",{attrs:{name:o.t("photos","Manage collaborators")},on:{close:function(l){o.showManageCollaboratorView=!1}}},[t("CollaboratorsSelectionForm",{attrs:{"album-name":o.album.basename,collaborators:o.album.collaborators},scopedSlots:o._u([{key:"default",fn:function({collaborators:l}){return[t("NcButton",{attrs:{"aria-label":o.t("photos","Save collaborators for this album."),type:"primary",disabled:o.loadingAddCollaborators},on:{click:function(e){return o.handleSetCollaborators(l)}},scopedSlots:o._u([{key:"icon",fn:function(){return[o.loadingAddCollaborators?t("NcLoadingIcon"):o._e()]},proxy:!0}],null,!0)},[o._v(" "+o._s(o.t("photos","Save"))+" ")])]}}],null,!1,507271420)})],1):o._e(),o.showEditAlbumForm?t("NcDialog",{attrs:{name:o.t("photos","Edit album details"),"close-on-click-outside":"",size:"normal"},on:{closing:function(l){o.showEditAlbumForm=!1}}},[t("AlbumForm",{attrs:{album:o.album},on:{done:o.redirectToNewName}})],1):o._e()],1)},V=[],$=B(D,T,V,!1,null,"42559684");const Fo=$.exports;export{Fo as default};
//# sourceMappingURL=AlbumContent-CHoa_BX-.chunk.mjs.map
